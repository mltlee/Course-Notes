\section{Banach and Hilbert Spaces}\label{sec:3}

\subsection{Banach and Hilbert Spaces}\label{subsec:3.1}
Functional analysis is the study of normed vector spaces and the continuous 
linear maps between them. Some of the most important examples of complete 
metric spaces are Banach spaces. Recall from PMATH 351 that a metric space is 
complete if every Cauchy sequence is convergent. We first give the definition 
of a normed vector space and a Banach space, and then illustrate these concepts 
with some examples. 

\begin{defn}{defn:3.1}
    A {\bf normed vector space} is a pair $(V, \|\cdot\|)$ where $V$ is a 
    vector space over $\C$ and $\|\cdot\| : V \to [0, \infty)$ is a 
    {\bf norm} on $V$. That is, $\|\cdot\|$ satisfies the following properties: 
    \begin{enumerate}[(1)]
        \item $\|v\| \geq 0$ for all $v \in V$, and $\|v\| = 0$ 
        if and only if $v = 0$; 
        \item $\|\alpha v\| = |\alpha|\|v\|$ for all $\alpha \in \C$ and 
        $v \in V$; and 
        \item $\|v + w\| \leq \|v\| + \|w\|$ for all $v, w \in V$. 
    \end{enumerate}
\end{defn}

Note that the property that $\|v\| = 0$ if and only if $v = 0$ says that 
$\|\cdot\|$ is non-degenerate; without this requirement, $\|\cdot\|$ is 
called a {\bf semi-norm}. Moreover, given $v, w \in V$, the above properties 
together give rise to a canonical metric defined by 
\[ d(v, w) = \|v - w\|. \]
Thus, a normed vector space is a special case of a metric space. 

\begin{defn}{defn:3.2}
    A {\bf Banach space} is a complete normed vector space. 
\end{defn}

We begin with the prototypical example of a normed vector space. 

\begin{exmp}{exmp:3.3} 
    Let $v = (v_1, v_2, \dots, v_n) \in \C^n$. We define the $1$-norm on $\C^n$ by 
    \[ \|v\|_1 = |v_1| + |v_2| + \cdots + |v_n|. \] 
    The $2$-norm on $\C^n$ is given by 
    \[ \|v\|_2 = (|v_1|^2 + |v_2|^2 + \cdots + |v_n|^2)^{1/2}. \] 
    More generally, for $1 \leq p < \infty$, the $p$-norm on $\C^n$ is 
    \[ \|v\|_p = (|v_1|^p + |v_2|^p + \cdots + |v_n|^p)^{1/p}. \] 
    The $\infty$-norm or supremum norm on $\C^n$ is 
    \[ \|v\|_\infty = \max\{|v_1|, |v_2|, \dots, |v_n|\}. \] 
    In fact, $\C^n$ equipped with each of these norms is a finite-dimensional 
    Banach space. 
\end{exmp}

We can also consider the continuous analogues for the space $C[a, b]$ 
of continuous functions on $[a, b]$.

\begin{exmp}{exmp:3.4}
    Let $f \in C[a, b]$. The $1$-norm on $C[a, b]$ is 
    \[ \|f\|_1 = \int_a^b |f(x)|\dd x. \] 
    The $2$-norm on $C[a, b]$ is given by 
    \[ \|f\|_2 = \left( \int_a^b |f(x)|^2\dd x \right)^{\!1/2}. \] 
    Finally, the $\infty$-norm on $C[a, b]$ is 
    \[ \|f\|_\infty = \sup_{x\in [a, b]} |f(x)|. \] 
    Note that $C[a, b]$ is a Banach space equipped with the supremum norm, 
    but it is not complete with respect to the $1$-norm and $2$-norm. 
\end{exmp}

Next, we consider inner product spaces and Hilbert spaces. The latter 
is a special case of a Banach space. 

\begin{defn}{defn:3.5} 
    An {\bf inner product space} is a pair $(H, \langle \cdot, \cdot \rangle)$ 
    where $H$ is a vector space over $\C$ and $\langle \cdot, \cdot \rangle
    : H \times H \to \C$ satisfies the following properties.
    \begin{enumerate}[(1)]
        \item $\langle x, y \rangle = \overline{\langle y, x \rangle}$
        for all $x, y \in H$. 
        \item For fixed $y \in H$, the map $x \mapsto \langle x, y \rangle$
        is a linear functional.
        \item {\bf Positive semidefiniteness:} $\langle x, x \rangle \geq 0$ 
        for all $x \in H$.
        \item {\bf Non-degeneracy:} $\langle x, x \rangle = 0$ if and only if 
        $x = 0$. 
    \end{enumerate} 
\end{defn}

Note that properties (1) and (2) imply that $\langle \cdot, \cdot \rangle$ 
is a {\bf sesquilinear form} on $H$. That is, $\langle \cdot, \cdot \rangle$ 
is linear in the left variable, and conjugately linear in the right 
variable. Moreover, we can define a norm on $H$ by 
\[ \|x\| = \langle x, x \rangle^{1/2}. \] 
We verify this fact in the following proposition. 

\begin{prop}{prop:3.6}
    Let $(H, \langle \cdot, \cdot \rangle)$ be an inner product space. 
    \begin{enumerate}[(1)]
        \item {\bf Cauchy-Schwarz inequality:} For all $x, y \in H$, 
        we have $|\langle x, y \rangle| \leq \|x\|\|y\|$. 
        \item $(H, \langle \cdot, \cdot \rangle)$ is a normed vector space. 
    \end{enumerate}
\end{prop}
\begin{pf}~
    \begin{enumerate}[(1)]

        \item Fix $x, y \in H$. The result is clear if $\|x\| = 0$ or 
        $\|y\| = 0$. Assume now that $x \neq 0$ and $y \neq 0$. For 
        $t \in \R$, define $p(t) = \|x - ty\|^2 \geq 0$. Observe that 
        \[ p(t) = \langle x - ty, x - ty \rangle = \|x\|^2 
        + t^2 \|y\|^2 + 2t\,\text{Re}\langle x, y \rangle. \] 
        By setting $a = \|y\|^2$, $b = 2\,\text{Re}\langle x, y \rangle$, 
        and $c = \|x\|^2$, we have $p(t) = at^2 + bt + c \geq 0$. 
        This means that $p(t)$ has at most one distinct real root, 
        and thus $b^2 - 4ac \leq 0$. In particular, we have 
        \[ 4(\text{Re}\langle x, y \rangle)^2 \leq 4\|x\|^2\|y\|^2, \] 
        or equivalently, $|\text{Re}\langle x, y \rangle| \leq \|x\|\|y\|$. 
        Choose $\alpha \in \C$ such that $|\alpha| = 1$ and 
        $\langle \alpha x, y \rangle = |\langle x, y \rangle|$. Then 
        we deduce that 
        \[ |\langle x, y \rangle| = \langle \alpha x, y \rangle
        = |\text{Re}\langle \alpha x, y \rangle| \leq \|\alpha x\|\|y\| 
        = \|x\|\|y\|. \] 

        \item We will show that $\|\cdot\|$ satisfies the triangle 
        inequality; the other properties are obvious. Given $x, y \in H$, 
        we have 
        \[ \|x + y\|^2 = \|x\|^2 + \|y\|^2 + 2\,\text{Re}\langle x, y \rangle 
        \leq \|x\|^2 + \|y\|^2 + 2\|x\|\|y\| = (\|x\| + \|y\|)^2. \qedhere \] 
    \end{enumerate}
\end{pf}

Since we have shown that $\|x\| = \langle x, x \rangle^{1/2}$ is indeed a 
norm on an inner product space $(H, \langle \cdot, \cdot \rangle)$, it 
makes sense to make the following definition. 

\begin{defn}{defn:3.7}
    A {\bf Hilbert space} is a complete inner product space. 
\end{defn}

\subsection{Banach Spaces of Measurable Functions} \label{subsec:3.2}
Recall that for $E \in {\cal L}$, we defined 
\[ L^1(E) = \left\{ f : E \to \C : f \text{ is measurable and } 
\int_E |f|\dd m < \infty \right\}, \] 
and we showed in Theorem~\ref{theo:2.57} that $L^1(E)$ is a vector space 
over $\C$. Given $f \in L^1(E)$, we will define the \textbf{$L^1$-norm} of 
$f$ by the value of the integral above, so 
\[ \|f\|_1 = \int_E |f|\dd m. \] 
Note that $\|\cdot\|_1$ is close to being a norm, since it is 
easy to see that $\|\alpha f\|_1 = |\alpha|\|f\|_1$ and 
\[ \|f + g\|_1 = \int_E |f+g|\dd m \leq \int_E (|f| + |g|)\dd m 
= \|f\|_1 + \|g\|_1 \] 
for any $f, g \in L^1(E)$ and $\alpha \in \C$. However, we are not quite 
there. Notice that 
\[ \|f\|_1 = \int_E |f|\dd m = 0 \] 
only implies that $f = 0$ almost everywhere, so we are not guaranteed 
non-degeneracy. 

To repair this, we can define an equivalence relation on $L^1(E)$ by 
$f \sim g$ if and only if $f - g = 0$ almost everywhere. Then $L^1(E)/\!\sim$ 
is a quotient space where $f \in L^1(E)$ is associated with the 
equivalence class $[f] \in L^1(E)/\!\sim$. It can be verified that 
$L^1(E)/\!\sim$ is a vector space over $\C$ with $\alpha [f] + \beta [g] 
= [\alpha f + \beta g]$ for all $\alpha, \beta \in \C$ and $f, g \in L^1(E)$. 
Moreover, we can define a norm on it by $\|[f]\|_1 = \|f\|_1$.

From now on, we will abuse notation and identify $L^1(E)$ with 
$L^1(E)/\!\sim$. That is, we only identify functions $f \in L^1(E)$ up to 
almost everywhere equality. Then $(L^1(E), \|\cdot\|_1)$ is a normed 
vector space. 

\begin{defn}{defn:3.8}
    Let $E \in {\cal L}$. We define the set of {\bf square-integrable 
    functions} over $E$ by 
    \[ L^2(E) = \left\{ f : E \to \C : f \text{ is measurable and }
    \int_E |f|^2 \dd m < \infty \right\}. \] 
    Equivalently, we have 
    \[ L^2(E) = \{f : E \to \C \mid f \text{ is measurable and } 
    f^2 \in L^1(E)\}. \] 
\end{defn}

\begin{prop}{prop:3.9}
    Let $E \in {\cal L}$ and $f, g \in L^2(E)$. Then $L^2(E)$ is an inner 
    product space with inner product given by 
    \[ \langle f, g \rangle = \int_E f\overline g\dd m. \] 
    In particular, this induces a norm on $L^2(E)$ via 
    \[ \|f\|_2 = \langle f, f \rangle^{1/2} = \left( \int_E |f|^2 \dd m 
    \right)^{\!1/2}, \] 
    which we call the {\bf $L^2$-norm}. 
\end{prop}
\begin{pf}
    Let $f, g \in L^2(E)$ and $\alpha \in \C$. It is clear that $\alpha f 
    \in L^2(E)$. To see that $f + g \in L^2(E)$, note that 
    $|f(x) + g(x)| \leq 2\max\{|f(x)|, |g(x)|\}$, and thus 
    \[ |f(x) + g(x)|^2 \leq 4\max\{|f(x)|^2, |g(x)|^2\} 
    \leq 4(|f(x)|^2 + |g(x)|^2). \] 
    It follows that 
    \[ \int_E |f + g|^2\dd m \leq \int_E 4(|f|^2 + |g|^2)\dd m < \infty, \] 
    so $f + g \in L^2(E)$ and we conclude that $L^2(E)$ is a $\C$-vector space. 

    Next, we verify that $\langle f, g \rangle$ is well-defined by 
    showing that $f\overline g \in L^1(E)$ for any $f, g \in L^2(E)$. 
    Note that if $a, b \geq 0$, then $ab \leq \frac12(a^2 + b^2)$. 
    By taking $a = |f(x)|$ and $b = |g(x)|$, we obtain 
    \[ |f(x) \overline g(x)| = |f(x)||g(x)| \leq \frac12(|f(x)|^2 + 
    |g(x)|^2). \] 
    Hence, we see that 
    \[ \int_E f\overline g\dd m \leq \frac12 \int_E |f|^2\dd m 
    + \frac12 \int_E |g|^2\dd m < \infty. \] 
    It is easily checked that $\langle \alpha f + \beta g, h \rangle 
    = \alpha \langle f, h \rangle + \beta \langle g, h \rangle$ 
    and $\langle f, g \rangle = \overline{\langle g, f \rangle}$ 
    for any $f, g, h \in L^2(E)$ and $\alpha, \beta \in \C$, so 
    $\langle \cdot, \cdot \rangle$ is a sesquilinear form on $L^2(E)$. 
    Finally, we have 
    \[ \langle f, f \rangle = \int_E |f|^2 \dd m \geq 0 \] 
    and $\langle f, f \rangle = 0$ if and only if $|f|^2 = 0$ almost 
    everywhere, which is equivalent to saying that $f = 0$ almost everywhere. 
    By identifying $L^2(E)$ with $L^2(E)/\!\sim$ where $\sim$ is the same 
    equivalence relation as above, this is enough to show that 
    $(L^2(E), \langle \cdot, \cdot \rangle)$ is an inner product space. 
\end{pf}

\begin{remark}{remark:3.10}
    Let $1 \leq p < \infty$ and $E \in {\cal L}$. Analogous to 
    what we have done so far, we can define 
    \[ L^p(E) = \left\{ f : E \to \C : f \text{ is measurable and }
    \int_E |f|^p \dd m < \infty \right\}. \] 
    and define the {\bf $L^p$-norm} by 
    \[ \|f\|_p = \left( \int_E |f|^p \dd m \right)^{\!1/p}. \] 
    It can be verified that this is indeed a norm by using H\"older's inequality. 
    This makes $(L^p(E), \|\cdot\|_p)$ a normed vector space. 
\end{remark}

Let $1 \leq p < \infty$. We now show that $L^p(E)$ is complete with 
respect to the norm $\|\cdot\|_p$ defined as above. In particular, 
this means that $(L^1(E), \|\cdot\|_1)$ is a Banach space and 
$(L^2(E), \langle \cdot, \cdot \rangle)$ is a Hilbert space. 
We recall that if a Cauchy sequence has a convergent subsequence in a 
metric space, then the Cauchy sequence also converges. 

\begin{theo}{theo:3.11}
    Let $1 \leq p < \infty$ and $E \in {\cal L}$. Then $(L^p(E), \|\cdot\|_p)$ 
    is complete. 
\end{theo}
\begin{pf}
    Fix $1 \leq p < \infty$, and take a Cauchy sequence $(f_n)_{n=1}^\infty$ 
    in $L^p(E)$ with respect to $\|\cdot\|_p$. Choose a subsequence 
    $n_1 < n_2 < n_3 < \cdots$ such that 
    \[ \|f_{n_{k+1}} - f_{n_k}\|_p < 2^{-k} \] 
    for all $k \in \N$. By the above remark, it suffices to find a function 
    $f \in L^p(E)$ such that $\|f - f_{n_k}\|_p \to 0$ as $k \to \infty$. 
    We define 
    \[ g_m(x) = |f_{n_1}(x)| + \sum_{k=1}^m |f_{n_{k+1}}(x) - f_{n_k}(x)|. \] 
    Then we see that each $g_m$ is measurable with $0 \leq g_1 
    \leq g_2 \leq \cdots$ and  
    \[ \|g_m\|_p \leq \|f_{n_1}\|_p + \sum_{k=1}^m \|f_{n_{k+1}} - 
    f_{n_k}\|_p \leq \|f_{n_1}\|_p + 1 = M. \]     
    Thus, we have $0 \leq g_1^p \leq g_2^p \leq \cdots$ and 
    \[ \int_E g_m^p \dd m \leq M^p \] 
    for all $m \in \N$. Now, define 
    \[ g(x) = \lim_{m\to\infty} g_m(x) = |f_{n_1}(x)| + 
    \sum_{k=1}^\infty |f_{n_{k+1}}(x) - f_{n_k}(x)|, \] 
    and observe that $g$ is measurable. By Lebesgue's Monotone Convergence 
    Theorem (Theorem~\ref{theo:2.48}), we have 
    \[ \int_E g^p\dd m = \lim_{m\to\infty} \int_E g_m^p\dd m \leq M^p 
    < \infty. \] 
    Thus, we have $g \in L^p(E)$ and in particular, $g(x) < \infty$ almost 
    everywhere. If $g(x) < \infty$, then we know that the telescoping series 
    \[ f_{n_1}(x) + \sum_{k=1}^\infty (f_{n_{k+1}}(x) - f_{n_k}(x)) \] 
    converges absolutely. This means that $\lim_{m\to\infty} f_{n_m}(x)$ 
    exists for almost every $x \in E$. Finally, define 
    \[ f(x) = \begin{cases}
        \lim_{m\to\infty} f_{n_m}(x), & \text{if } g(x) < \infty, \\ 
        0, & \text{otherwise.}
    \end{cases} \] 
    Then $f_{n_k} \to f$ almost everywhere, so $f$ is measurable. Moreover, 
    $|f_{n_k}| \leq g_{k-1} \leq g$ implies that $|f| \leq g$. This means that 
    \[ \int_E |f|^p \dd m \leq \int_E g^p \dd m < \infty, \] 
    so $f \in L^p(E)$. Finally, observe that 
    \[ \|f_{n_m} - f\|_p = \left\| \sum_{k=m}^\infty (f_{n_{k+1}} 
    - f_{n_k}) \right\|_p \leq \sum_{k=m}^\infty \|f_{n_{k+1}} - f_{n_k}\|_p 
    \to 0. \] 
    Then applying Lebesgue's Dominated Convergence Theorem to 
    $f_{n_{m+1}}^p \to f^p$ with $|f_{n_{m+1}}|^p \leq g^p \in L^1(E)$ implies 
    that $f^p \in L^1(E)$, which is equivalent to saying that 
    $f \in L^p(E)$. This completes the proof. 
\end{pf}

\begin{cor}{cor:3.12}
    Let $1 \leq p < \infty$ and let $(f_n)_{n=1}^\infty \subseteq L^p(E)$ 
    be a Cauchy sequence with limit $f \in L^p(E)$. Then there exists a 
    subsequence $(f_{n_k})_{k=1}^\infty$ such that $f_{n_k}(x) \to f(x)$ 
    for almost every $x \in E$. 
\end{cor}
\begin{pf}
    Take the subsequence $(f_{n_k})_{k=1}^\infty$ from the proof of the 
    previous theorem. 
\end{pf}

\begin{remark}{remark:3.13}
    We know that if $f_n \to f$ with respect to $\|\cdot\|_p$ for 
    $1 \leq p < \infty$, then $f_{n_k}(x) \to f(x)$ for almost every 
    $x \in E$ for some subsequence $(f_{n_k})_{k=1}^\infty$. But 
    does this imply that $f_n \to f$ for the original sequence? 

    The answer is no. Define $(f_n)_{n=1}^\infty$ by $f_1 = \chi_{[0, 1]}$,
    $f_2 = \chi_{[0, 1/2]}$, $f_3 = \chi_{[1/2, 1]}$, $f_4 = \chi_{[0, 1/3]}$,
    $f_5 = \chi_{[1/3, 2/3]}$, $f_6 = \chi_{[2/3, 1]}$, and so on. Then 
    $\|f_n\|_p \to 0$ for $1 \leq p < \infty$, but $f_n$ does not converge 
    for any $x \in [0, 1]$. Therefore, we really need a subsequence 
    $(f_{n_k})_{k=1}^\infty$ in general. 
\end{remark}

Let $E \in {\cal L}$ with $m(E) > 0$. We now consider the space $L^\infty(E)$.

\begin{defn}{defn:3.14}
    A measurable function $f : E \to \C$ is called {\bf essentially bounded} 
    if there exists $A > 0$ such that $|f| \leq A$ almost everywhere. 
    That is, we have $m\{x \in E : |f(x)| > A\} = 0$. 

    When $f : E \to \C$ is essentially bounded, the {\bf essential supremum} 
    of $|f|$ is defined to be 
    \[ \|f\|_\infty = \esssup_{x\in E} |f(x)| = 
    \inf\{A \geq 0 \mid m\{x \in E : |f(x)| > A\} = 0\}. \] 
    Then the space $L^\infty(E)$ is given by 
    \[ L^\infty(E) = \{f : E \to \C \mid f \text{ is measurable and } 
    \|f\|_\infty < \infty\}. \] 
\end{defn}

Similar to $(L^p(E), \|\cdot\|_p)$ for $1 \leq p < \infty$, we have that 
$L^\infty(E)$ equipped with the essential supremum is a normed vector space. 
In fact, it is a Banach space. 

\begin{prop}{prop:3.15}
    $(L^\infty(E), \|\cdot\|_\infty)$ is a normed vector space. 
\end{prop}
\begin{pf}
    Let $\alpha \in \C$ and $f, g \in L^\infty(E)$. Note that $|f| > A$ 
    if and only if $|\alpha f| \geq |\alpha|A$ for all $\alpha \in 
    \C \setminus \{0\}$, so $\|\alpha f\|_\infty = |\alpha|\|f\|_\infty$ 
    and thus $\alpha f \in L^\infty(E)$. To see that $f + g \in L^\infty(E)$, 
    there exist $A, B > 0$ such that $|f(x)| \leq A$ and $|g(x)| \leq B$
    for almost every $x \in E$. Then for almost every $x \in E$, we get 
    \[ |f(x) + g(x)| \leq |f(x)| + |g(x)| \leq A + B < \infty, \] 
    which implies that $f + g \in L^\infty(E)$. 

    Now, we check that $\|\cdot\|_\infty$ is a norm. It is clear that 
    $\|f\|_\infty \geq 0$. We claim that $|f| \leq \|f\|_\infty$ and 
    $|g| \leq \|g\|_\infty$ almost everywhere. Indeed, observe that 
    \[ m\{x \in E : |f(x)| > \|f\|_\infty + 1/n\} = 0 \] 
    by the definition of $\|f\|_\infty$, and thus 
    \[ m\{x \in E : |f(x)| > \|f\|_\infty\} = m\!\left( \bigcup_{n=1}^\infty 
    \{x \in E : |f(x)| > \|f\|_\infty + 1/n\} \right) = 0. \] 
    In particular, if $\|f\|_\infty = 0$, then $|f| = 0$ almost everywhere 
    and hence $f = 0$ almost everywhere. Moreover, we have  
    \[ |f + g| \leq |f| + |g| \leq \|f\|_\infty + \|g\|_\infty \] 
    almost everywhere, which implies that 
    \[ m\{x \in E : |f(x) + g(x)| > \|f\|_\infty + \|g\|_\infty\} = 0. \] 
    This means that $\|f + g\|_\infty \leq \|f\|_\infty + \|g\|_\infty$, 
    so $\|\cdot\|_\infty$ is a norm as desired. 
\end{pf}

\begin{theo}{theo:3.16}
    $(L^\infty(E), \|\cdot\|_\infty)$ is a Banach space. 
\end{theo}
\begin{pf}
    Let $(f_n)_{n=1}^\infty$ be a Cauchy sequence in $(L^\infty(E), 
    \|\cdot\|_\infty)$. Pick a subsequence $(f_{n_k})_{k=1}^\infty$ such that 
    \[ \sum_{k=1}^\infty \|f_{n_{k+1}} - f_{n_k}\|_\infty < \infty. \] 
    Then we have 
    \[ g(x) = |f_{n_1}(x)| + \sum_{k=1}^\infty |f_{n_{k+1}}(x) - f_{n_k}(x)|
    < \infty \] 
    for almost every $x \in E$. This means that 
    \[ \lim_{m\to\infty} f_{n_m}(x) = \lim_{m\to\infty} 
    \left( f_{n_1}(x) + \sum_{k=1}^{m-1} (f_{n_{k+1}}(x) - f_{n_k}(x)) \right) \] 
    exists for almost every $x \in E$. Define $f : E \to \C$ by 
    \[ f(x) = \begin{cases}
        \lim_{m\to\infty} f_{n_m}(x), & \text{if it converges,} \\ 
        0, & \text{otherwise.} 
    \end{cases} \] 
    Then we have $\|f - f_{n_m}\|_\infty \to 0$ because for 
    $x \in \{y \in E | \lim_{m\to\infty} f_{n_m}(y) = f(y)\} =: A$, 
    we get 
    \[ |f_{n_m}(x) - f(x)| \leq \sum_{k=m}^\infty |f_{n_{k+1}}(x) - f_{n_k}(x)|, \] 
    which converges uniformly for $x \in A$. Since $m(E \setminus A) = 0$, 
    this gives as $\|f - f_{n_m}\|_\infty \to 0$ as claimed. Finally, we obtain 
    \[ 0 \leq \lim_{n\to\infty} \|f_n - f\|_\infty \leq 
    \lim_{n\to\infty} (\|f_n - f_{n_m}\|_\infty + \|f_{n_m} - f\|_\infty) 
    = 0. \qedhere \] 
\end{pf}

\begin{remark}{remark:3.17}
    If $m(E) < \infty$, then $L^\infty(E) \subseteq L^2(E) \subseteq L^1(E)$. 
    Indeed, if $f \in L^\infty(E)$, then 
    \[ \|f\|_2^2 = \int_E |f|^2\dd m \leq \|f\|_\infty^2 \int_E 1\dd m 
    = \|f\|_\infty^2 m(E), \] 
    and similarly, we have $\|f\|_1 \leq \|f\|_\infty m(E)$. 

    This result is not true without the assumption that $m(E) < \infty$. 
    For example, let $E = \R$, and define $f(x) = 1$ for all $x \in \R$, 
    $g(x) = 1/x$ for $x \geq 1$ and $g(x) = 0$ otherwise, and 
    $h(x) = x^{-1/2}$ on $(0, 1)$ and $h(x) = 0$ otherwise. Then 
    $f \in L^\infty(\R) \setminus (L^1(\R) \cup L^2(\R))$, 
    $g \in L^2(\R) \setminus L^1(\R)$, and $h \in L^1(\R) \setminus 
    (L^2(\R) \cup L^\infty(\R))$. 
\end{remark}

\subsection{Density and Approximation Results} \label{subsec:3.3}
We now consider the density of certain spaces in $L^p(\R)$, where 
$1 \leq p \leq \infty$. 

\begin{defn}{defn:3.18}
    The space of compactly supported continuous functions is given by 
    \[ C_c(\R) = \{f : \R \to \C \mid \text{$f$ is continuous and 
    there exists a compact subset $K \subseteq \R$ with $f|_{\R \setminus K}
    = 0$}\}. \] 
    The space of simple and measurable functions is given by 
    \[ S(\R) = \{f : \R \to \C \mid \text{$f$ is simple and measurable}\}. \] 
    The space of simple and measurable functions which are also Lebesgue 
    integrable is defined by 
    \[ S_1(\R) = S(\R) \cap L^1(\R) = \left\{ \varphi = \sum_{i=1}^n 
    \alpha_i \chi_{E_i} : \alpha_i \in \C,\, m(E_i) < \infty \right\}. \] 
\end{defn}

Note that for $1 \leq p \leq \infty$, we have $C_c(\R) \subseteq L^p(\R)$ and 
$S_1(\R) \subseteq L^p(\R)$ as subspaces. Moreover, we have $S(\R) \subseteq 
L^\infty(\R)$ as a subspace. None of these are closed subspaces though. 

\begin{theo}{theo:3.19}
    $S(\R)$ is dense in $L^p(\R)$ for $1 \leq p \leq \infty$. That is, 
    for $f \in L^p(\R)$, there exists a sequence $(\varphi_n)_{n=1}^\infty$ 
    of simple measurable functions in $L^p(\R)$ such that 
    $\varphi_n \to f$ with respect to $\|\cdot\|_p$. 
\end{theo}
\begin{pf}
    Let $f \in L^p(\R)$. Since $f$ is measurable, we know from Theorem~\ref{theo:2.43} 
    that we can approximate $f$ using simple measurable functions. In particular, 
    there exists a sequence $(\varphi_n)_{n=1}^\infty$ of simple measurable 
    functions such that $\varphi_n \to f$ pointwise and 
    \[ |\varphi_1| \leq |\varphi_2| \leq \cdots \leq |f|. \] 
    When $p = \infty$, we have $\varphi_n \to f$ almost uniformly. 
    This means that $\|\varphi_n - f\|_\infty \to 0$. On the other hand, 
    if $1 \leq p < \infty$, then we have $|f - \varphi_n|^p \to 0$ 
    pointwise, and we know that 
    \[ |f - \varphi_n|^p \leq (2|f|)^p \in L^1(\R) \] 
    since $f \in L^p(\R)$. This means that $\varphi_n \in L^p(\R)$, 
    and applying Lebesgue's Dominated Convergence Theorem (Theorem~\ref{theo:2.58})
    implies that 
    \[ \|f - \varphi_n\|_p^p = \int_{\R} |f - \varphi_n|^p\dd m \to 0. \qedhere \] 
\end{pf}

\begin{theo}{theo:3.20}
    $C_c(\R)$ is dense in $L^p(\R)$ for $1 \leq p < \infty$. 
\end{theo}
\begin{pf}
    Let $\eps > 0$ and $f \in L^p(\R)$ where $1 \leq p < \infty$. We need 
    to find $g \in C_c(\R)$ such that $\|f - g\|_p < \eps$. 

    Since $L_p(\R)$ is the closure of the simple integrable functions, 
    it suffices to assume that $f = \varphi$ is simple. Indeed, if we 
    can find a simple function $\varphi$ such that $\|f - \varphi\|_p < \eps/2$
    and a function $g \in C_c(\R)$ such that $\|\varphi - g\|_p < \eps/2$, 
    then the triangle inequality gives us the result. So we have 
    \[ \varphi = \sum_{i=1}^n \alpha_i \chi_{E_i} \] 
    where $\alpha \in \C$ and $E_i \in {\cal L}$ with $m(E_i) < \infty$. 

    We can further reduce this problem to approximating $\varphi = \chi_E$ 
    for $E \in {\cal L}$ with $m(E) < \infty$, because the triangle inequality 
    again assures us that 
    \[ \left\| \sum_{i=1}^n \alpha_i \chi_{E_i} - \sum_{i=1}^n 
    \alpha_i g_i \right\|_p \leq \sum_{i=1}^n |\alpha_i| \|\chi_{E_i} 
    - g_i\|_p \] 
    for some $g_i \in C_c(\R)$. 

    Finally, fix $E \in {\cal L}$ with $m(E) < \infty$. We can write 
    $E = \bigcup_{n\in\N} E \cap (-n, n)$, and observe that 
    $m(E) = \lim_{n\to\infty} m(E_n)$ by the continuity of measure. 
    We leave it as an exercise to show that 
    \[ \chi_E = \lim_{n\to\infty} \chi_{E_n} \] 
    with respect to $\|\cdot\|_p$. So without loss of generality, 
    we can assume that $E \in {\cal L}$ is bounded, say $E \subseteq 
    (-n, n)$ for some $n \in \N$. We will find $g \in C_c(\R)$ 
    such that $\|\chi_E - g\|$ is bounded above by $\eps$ multiplied 
    by a constant. 

    Recall from the structure theorem of Lebesgue measurable sets 
    (Theorem~\ref{theo:2.22}) that there exists a closed set $F$ and 
    an open set $G$ such that $F \subseteq E \subseteq G$ and 
    $m(G \setminus F) < \eps$. We may assume without loss of generality 
    that $G \subseteq (-n, n)$ because we can chop off elements outside 
    of this interval otherwise. 

    We now design a $g \in C_c(\R)$ such that 
    \begin{enumerate}[(i)]
        \item $g(x) \in [0, 1]$ for all $x \in \R$; 
        \item $g(x) = 1$ for all $x \in F$; and 
        \item $g(x) = 0$ for all $x \in G^c$. 
    \end{enumerate}
    Given such a function $g \in C_c(\R)$, we are done because 
    \[ \|\chi_E - g\|_p^p = \int_G |\chi_E - g|^p \dd m 
    = \int_F 0\dd m + \int_{G\setminus F} |\chi_E - g|^p\dd m 
    \leq 0 + m(G \setminus F) 2^p < 2^p\eps. \] 
    To construct this function, recall that for $S \subseteq \R$ with 
    $S \neq \varnothing$, we define 
    \[ d(x, S) = \inf\{|x - y| : y \in S\} \] 
    for any fixed $x \in \R$. We leave it as an exercise to show that 
    $d(\cdot, S) : \R \to [0, \infty)$ is continuous. Then define 
    \[ g(x) = \frac{d(x, G^c)}{d(x, G^c) + d(x, F)}. \] 
    This is well-defined since $F \cap G^c = \varnothing$ 
    and so $d(x, G^c) + d(x, F) \neq 0$. Moreover, it is continuous 
    because it is the composition of continuous functions. Finally, 
    it is easily seen that $g$ satisfies all three properties above, 
    which completes the proof.
\end{pf}

We note that $C_c(\R)$ is \emph{not} dense in $L^\infty(\R)$; this can be 
seen by taking the function $f(x) = 1$ for all $x \in \R$. 

\begin{cor}{cor:3.21}
    Let $a < b$ be finite. Then $C[a, b]$ is dense in $L^p[a, b]$ for 
    $1 \leq p \leq \infty$. 
\end{cor}
\begin{pf}
    Repeat the same argument as Theorem~\ref{theo:3.20} by reducing it to 
    the case where $f = \chi_E$ with $E \subseteq (a + 1/n, b - 1/n)$. 
    The case where $p = \infty$ is not an issue here because we have 
    $L^1[a, b] \supseteq L^p[a, b] \supseteq L^\infty[a, b] \supseteq 
    C[a, b]$, and being dense in $L^1[a, b]$ implies being dense in 
    $L^\infty[a, b]$ because $L^1[a, b]$ is a larger space. 
\end{pf}