\section{Lagrangian Relaxation and the $k$-median Problem} \label{sec:9}

\subsection{The $k$-median Problem} \label{subsec:9.1}
We now discuss a variant of the uncapacitated facility location problem, 
known as the $k$-median problem. As before, we are given a set of 
facilities $F$, a set of clients $D$, and metric assignment costs $c_{ij}$ 
for all $i \in F$ and $j \in D$. However, there are no longer 
facility opening costs $f_i$ for all $i \in F$; instead, we are given an integer $k$ 
that is an upper bound on the number of facilities we can open. 
In other words, we wish to select facilities $S \subseteq F$ 
such that $|S| \leq k$ while minimizing the cost 
\[ c(S) = \sum_{j\in D} \min_{i\in S} c_{ij}. \]
We define the binary variables $y_i \in \{0, 1\}$ to indicate whether or 
not we open facility $i$, and $x_{ij} \in \{0, 1\}$ to indicate if 
client $j$ is assigned to facility $i$. To limit the number of open facilities, 
we introduce the constraint $\sum_{i\in F} y_i \leq k$. This gives the 
following IP formulation for the $k$-median problem:
\begin{align*}
    \min\quad & \sum_{i\in F} \sum_{j\in D} c_{ij} x_{ij} \\ 
    \text{subject to}\quad & \sum_{i\in F} x_{ij} = 1
    && \text{for all $j \in D$} \\
    & x_{ij} \leq y_i && \text{for all $i \in F$ and $j \in D$} \\
    & \sum_{i\in F} y_i \leq k \\
    & x_{ij} \in \{0, 1\} && \text{for all $i \in F$ and $j \in D$} \\ 
    & y_i \in \{0, 1\} && \text{for all $i \in F$}
\end{align*}
The only difference with the uncapacitated facility location problem 
is the objective function now that there are no opening costs, 
and the additional constraint we mentioned above. The LP relaxation is then 
obtained by replacing $x_{ij} \in \{0, 1\}$ and $y_i \in \{0, 1\}$ 
with $x_{ij} \geq 0$ and $y_i \geq 0$ respectively. We will denote the 
LP relaxation by (PrimalLP).

\subsection{Lagrangian Relaxation} \label{subsec:9.2}
We will use the idea of Lagrangian relaxation to reduce the $k$-median 
problem to the uncapacitated facility location problem. To do this, 
we would like to remove the constraint that $\sum_{i\in F} y_i \leq k$. 
Fix $\lambda \geq 0$, and introduce the penalty term $\lambda \cdot (\sum_{i\in F} y_i - k)$
to the objective function. This penalty will prefer solutions that 
respect the constraint. Our new LP, which we call (LPrimalLP), is given by 
\begin{align*}
    \min\quad & \sum_{i\in F} \sum_{j\in D} c_{ij} x_{ij} + \sum_{i\in F} \lambda y_i - \lambda k \\ 
    \text{subject to}\quad & \sum_{i\in F} x_{ij} = 1
    && \text{for all $j \in D$} \\
    & x_{ij} \leq y_i && \text{for all $i \in F$ and $j \in D$} \\
    & x_{ij} \geq 0 && \text{for all $i \in F$ and $j \in D$} \\ 
    & y_i \geq 0 && \text{for all $i \in F$}
\end{align*}
Observe that aside from the additional constant term $-\lambda k$, the objective 
function looks like that of the LP relaxation for the uncapacitated 
facility problem where the facility opening costs are all $f_i = \lambda$. 
Note that any feasible solution for the LP relaxation (PrimalLP) of the $k$-median 
problem is also feasible for (LPrimalLP). Moreover, any feasible 
solution for (PrimalLP) has lower objective value in (LPrimalLP) 
than (PrimalLP) since $\sum_{i\in F} y_i - k \leq 0$. Therefore, we find that 
\[ \text{OPT}_{\text{PrimalIP}} \geq \text{OPT}_{\text{PrimalLP}} \geq 
\text{OPT}_{\text{LPrimalLP}}. \] 
Taking the dual of (LPrimalLP), say (LDualLP), we obtain 
\begin{align*}
    \max\quad & \sum_{j\in D} v_j - \lambda k \\ 
    \text{subject to}\quad & \sum_{j\in D} w_{ij} \leq \lambda 
    && \text{for all $i \in F$} \\
    & v_j - w_{ij} \leq c_{ij} && \text{for all $i \in F$ and $j \in D$} \\
    & w_{ij} \geq 0 && \text{for all $i \in F$ and $j \in D$} 
\end{align*}
This is the same as the dual of the LP relaxation for the 
uncapacitated facility location problem, except that the facility costs 
are $\lambda$ and there is an extra constant term $-\lambda k$ in the 
objective function. 

